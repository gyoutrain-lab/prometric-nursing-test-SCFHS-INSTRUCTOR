<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Prometric Fast-Fail System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; padding:20px; }
.card { background:#fff; padding:20px; max-width:1000px; margin:auto; border-radius:8px; }
.hidden { display:none; }
button { margin-top:10px; padding:10px; width:100%; text-align:left; }
.fail { color:red; font-weight:bold; }
.pass { color:green; font-weight:bold; }
hr { margin:20px 0; }
</style>
</head>

<body>

<!-- START -->
<div class="card" id="startScreen">
  <h2>Prometric Nurse Technician Exam</h2>
  <p>Focus: Safety, ABC, Scope, Immediate Action</p>
  <input id="candidateName" type="text" placeholder="Enter your name">
  <button onclick="startExam()">Start Exam</button>
</div>

<!-- EXAM -->
<div class="card hidden" id="examScreen">
  <h3 id="qNo"></h3>
  <p id="qText"></p>
  <div id="options"></div>
</div>

<!-- RESULT -->
<div class="card hidden" id="resultScreen">
  <h3>Exam Result</h3>
  <p id="resultText"></p>
  <p id="nameText"></p>
  <button onclick="showDashboard()">Instructor Dashboard</button>
</div>

<!-- INSTRUCTOR DASHBOARD -->
<div class="card hidden" id="dashboard">
  <h3>Instructor Dashboard — Decision Analysis</h3>
  <div id="analysis"></div>
</div>

<script>
let candidateName = "";
let current = 0;
let failed = false;
let failures = [];

/* ================= QUESTION BANK =================
   Structure supports 100+ questions.
   Only 3 shown here to keep file readable.
================================================== */

const questions = [
{
  q: "Patient suddenly becomes cyanotic with SpO₂ 82%. Priority action?",
  correct: "Apply oxygen and assess airway",
  tieBreaker: "ABC — airway and oxygenation before anything else",
  options: [
    {
      t: "Document oxygen saturation",
      unsafe: true,
      whyWrong: "Documentation delays life-saving oxygen delivery during hypoxia.",
      misleading: "Professional documentation wording",
      violation: "Delayed action / ABC violation"
    },
    {
      t: "Notify physician",
      unsafe: true,
      whyWrong: "Waiting for orders when immediate airway support is required.",
      misleading: "Authority bias",
      violation: "Waiting for orders"
    },
    {
      t: "Apply oxygen and assess airway",
      unsafe: false,
      whyCorrect: "Immediate oxygenation treats the life-threatening problem."
    },
    {
      t: "Continue to monitor closely",
      unsafe: true,
      whyWrong: "Monitoring does not correct hypoxia.",
      misleading: "Monitoring trap",
      violation: "Delay"
    }
  ]
},

{
  q: "Patient choking and unable to speak. First action?",
  correct: "Perform abdominal thrusts",
  tieBreaker: "Airway obstruction requires immediate physical intervention",
  options: [
    {
      t: "Assess vital signs",
      unsafe: true,
      whyWrong: "Assessment delays removal of airway obstruction.",
      misleading: "Assessment-first wording",
      violation: "Skipped airway"
    },
    {
      t: "Call physician",
      unsafe: true,
      whyWrong: "Physician notification does not clear the airway.",
      misleading: "Authority reflex",
      violation: "Delay"
    },
    {
      t: "Perform abdominal thrusts",
      unsafe: false,
      whyCorrect: "Removes the airway obstruction immediately."
    },
    {
      t: "Document choking episode",
      unsafe: true,
      whyWrong: "Documentation does not resolve choking.",
      misleading: "Documentation reflex",
      violation: "Delayed action"
    }
  ]
},

{
  q: "Medication dose appears unusually high. Best action?",
  correct: "Clarify the order before administration",
  tieBreaker: "Unsafe medication must be questioned before giving",
  options: [
    {
      t: "Administer as written to avoid delay",
      unsafe: true,
      whyWrong: "Blind obedience can cause medication harm.",
      misleading: "Avoid delay wording",
      violation: "Unsafe obedience"
    },
    {
      t: "Document concern and proceed",
      unsafe: true,
      whyWrong: "Documentation does not prevent overdose.",
      misleading: "Professional-sounding action",
      violation: "Scope violation"
    },
    {
      t: "Clarify the order before administration",
      unsafe: false,
      whyCorrect: "Prevents potential medication error."
    },
    {
      t: "Ask another nurse later",
      unsafe: true,
      whyWrong: "Delays correction of a dangerous order.",
      misleading: "Team consultation delay",
      violation: "Delay"
    }
  ]
}
];

/* ================= EXAM ENGINE ================= */

function startExam() {
  candidateName = document.getElementById("candidateName").value || "Unnamed";
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");
  loadQuestion();
}

function loadQuestion() {
  if (current >= questions.length || failed) return endExam();

  const q = questions[current];
  document.getElementById("qNo").innerText = "Question " + (current + 1);
  document.getElementById("qText").innerText = q.q;

  const opt = document.getElementById("options");
  opt.innerHTML = "";

  q.options.forEach(o => {
    const b = document.createElement("button");
    b.innerText = o.t;
    b.onclick = () => choose(o);
    opt.appendChild(b);
  });
}

function choose(option) {
  if (option.unsafe) {
    failed = true;
    failures.push({
      question: questions[current].q,
      chosen: option.t,
      whyWrong: option.whyWrong,
      misleading: option.misleading,
      correct: questions[current].correct,
      tieBreaker: questions[current].tieBreaker,
      violation: option.violation
    });
  }
  current++;
  loadQuestion();
}

function endExam() {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  document.getElementById("resultText").innerHTML =
    failed ? "<span class='fail'>FAIL</span>" : "<span class='pass'>PASS</span>";

  document.getElementById("nameText").innerText =
    "Candidate name: " + candidateName;
}

/* ================= INSTRUCTOR DASHBOARD ================= */

function showDashboard() {
  document.getElementById("dashboard").classList.remove("hidden");
  const box = document.getElementById("analysis");
  box.innerHTML = "";

  failures.forEach((f, i) => {
    box.innerHTML += `
      <hr>
      <h4>Failure ${i + 1}</h4>
      <p><strong>Question:</strong> ${f.question}</p>
      <p><strong>Candidate chose:</strong> ❌ ${f.chosen}</p>
      <p><strong>Why incorrect:</strong><br>${f.whyWrong}</p>
      <p><strong>Misleading wording used:</strong><br>${f.misleading}</p>
      <p><strong>Correct answer:</strong> ✅ ${f.correct}</p>
      <p><strong>Tie-breaker rule:</strong><br>${f.tieBreaker}</p>
      <p><strong>Prometric intent:</strong><br>
        Eliminate candidates who delay, document, or wait instead of acting on safety.
      </p>
    `;
  });

  if (failures.length === 0) {
    box.innerHTML = "<p>No unsafe decisions. Candidate demonstrated safe prioritization.</p>";
  }
}
</script>

</body>
</html>
