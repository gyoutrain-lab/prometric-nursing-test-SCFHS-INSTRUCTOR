<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Prometric Nurse Technician Fast-Fail Exam</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 20px;
}
h1, h2 {
  color: #b00020;
}
.card {
  background: white;
  padding: 20px;
  border-radius: 8px;
  max-width: 900px;
  margin: auto;
}
button {
  padding: 10px 16px;
  margin-top: 10px;
}
.hidden {
  display: none;
}
.fail {
  color: red;
  font-weight: bold;
}
.pass {
  color: green;
  font-weight: bold;
}
.option {
  margin: 8px 0;
}
.dashboard table {
  width: 100%;
  border-collapse: collapse;
}
.dashboard th, .dashboard td {
  border: 1px solid #ccc;
  padding: 8px;
}
.dashboard th {
  background: #eee;
}
</style>
</head>

<body>

<div class="card" id="startScreen">
  <h1>Prometric Nurse Technician Exam</h1>
  <p>Focus: Safety, ABC, Scope, Immediate Action</p>
  <input id="userId" placeholder="Enter User ID">
  <br>
  <button onclick="startExam()">Start Exam</button>
</div>

<div class="card hidden" id="examScreen">
  <h2 id="qNumber"></h2>
  <p id="questionText"></p>
  <div id="options"></div>
</div>

<div class="card hidden" id="resultScreen">
  <h2>Exam Result</h2>
  <p id="finalResult"></p>
  <p id="failReason"></p>
  <button onclick="showDashboard()">Instructor Dashboard</button>
</div>

<div class="card hidden dashboard" id="dashboard">
  <h2>Instructor Dashboard</h2>
  <table>
    <tr>
      <th>User ID</th>
      <th>Result</th>
      <th>Risk Pattern</th>
    </tr>
    <tr>
      <td id="dUser"></td>
      <td id="dResult"></td>
      <td id="dRisk"></td>
    </tr>
  </table>
</div>

<script>
let user = "";
let current = 0;
let failed = false;
let failReason = "";

const questions = [
/* ===== MODULE: AIRWAY ===== */
{
 q: "Patient suddenly becomes cyanotic with SpOâ‚‚ 82%. What is the priority action?",
 options: [
  { t: "Document oxygen saturation finding", unsafe: true, reason: "Documentation delay" },
  { t: "Notify physician of abnormal SpOâ‚‚", unsafe: true, reason: "Waiting for orders" },
  { t: "Apply oxygen and assess airway patency", unsafe: false },
  { t: "Continue to monitor closely", unsafe: true, reason: "Delayed action" }
 ]
},

{
 q: "Patient is choking and unable to speak. What should you do first?",
 options: [
  { t: "Call rapid response team", unsafe: true, reason: "Delay" },
  { t: "Assess vital signs thoroughly", unsafe: true, reason: "Skipped airway" },
  { t: "Perform abdominal thrusts", unsafe: false },
  { t: "Document airway obstruction", unsafe: true, reason: "Documentation reflex" }
 ]
},

/* ===== MODULE: CIRCULATION ===== */
{
 q: "Post-op patient reports dizziness and pale skin. Priority?",
 options: [
  { t: "Reassess in 15 minutes", unsafe: true, reason: "Delay bias" },
  { t: "Check blood pressure and pulse immediately", unsafe: false },
  { t: "Document findings", unsafe: true, reason: "Documentation reflex" },
  { t: "Notify physician after assessment", unsafe: true, reason: "Delayed action" }
 ]
},

/* ===== MODULE: MEDICATIONS ===== */
{
 q: "Medication order seems unusually high. What is the best action?",
 options: [
  { t: "Administer as written to avoid delay", unsafe: true, reason: "Unsafe obedience" },
  { t: "Clarify the order before administration", unsafe: false },
  { t: "Document concern and proceed", unsafe: true, reason: "Scope violation" },
  { t: "Ask another nurse later", unsafe: true, reason: "Delay" }
 ]
},

/* ===== MODULE: INFECTION CONTROL ===== */
{
 q: "Patient with suspected sepsis has fever and tachycardia. Priority?",
 options: [
  { t: "Apply standard precautions and monitor", unsafe: true, reason: "Passive response" },
  { t: "Document abnormal vitals", unsafe: true, reason: "Documentation trap" },
  { t: "Initiate sepsis protocol per facility policy", unsafe: false },
  { t: "Wait for lab confirmation", unsafe: true, reason: "Delay bias" }
 ]
}
/* EASY 1â€“8 */
{module:"AIRWAY",level:"EASY",stem:"SpOâ‚‚ drops to 84% suddenly.",options:[
{text:"Document finding",correct:false,reason:"Delay"},
{text:"Notify physician",correct:false,reason:"Waiting"},
{text:"Apply oxygen and assess airway",correct:true},
{text:"Reassure patient",correct:false,reason:"Unsafe reassurance"}]},
{module:"AIRWAY",level:"EASY",stem:"Patient coughing, unable to speak.",options:[
{text:"Call physician",correct:false,reason:"Delay"},
{text:"Encourage relaxation",correct:false,reason:"No intervention"},
{text:"Perform choking intervention",correct:true},
{text:"Document event",correct:false,reason:"Paperwork trap"}]},
{module:"AIRWAY",level:"EASY",stem:"Labored breathing noted.",options:[
{text:"Monitor closely",correct:false,reason:"Delay"},
{text:"Prepare report",correct:false,reason:"Non-action"},
{text:"Position and assess airway",correct:true},
{text:"Notify later",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"EASY",stem:"Snoring respirations heard.",options:[
{text:"Document sound",correct:false,reason:"Delay"},
{text:"Monitor",correct:false,reason:"No airway action"},
{text:"Open airway",correct:true},
{text:"Wait for MD",correct:false,reason:"Unsafe wait"}]},
{module:"AIRWAY",level:"EASY",stem:"Patient restless, hypoxic.",options:[
{text:"Reassure",correct:false,reason:"False calm"},
{text:"Chart behavior",correct:false,reason:"Delay"},
{text:"Apply oxygen",correct:true},
{text:"Notify physician",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"EASY",stem:"Secretions blocking airway.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Wait suction order",correct:false,reason:"Scope misunderstanding"},
{text:"Clear airway per protocol",correct:true},
{text:"Monitor",correct:false,reason:"Unsafe"}]},
{module:"AIRWAY",level:"EASY",stem:"Shortness of breath increases.",options:[
{text:"Observe",correct:false,reason:"Delay"},
{text:"Prepare note",correct:false,reason:"Paperwork"},
{text:"Assess airway and breathing",correct:true},
{text:"Call MD",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"EASY",stem:"Patient gasping.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Reassure",correct:false,reason:"Unsafe"},
{text:"Immediate airway support",correct:true},
{text:"Notify physician",correct:false,reason:"Waiting"}]},

/* MEDIUM 9â€“15 */
{module:"AIRWAY",level:"MEDIUM",stem:"Asthma patient wheezing, alert.",options:[
{text:"Monitor",correct:false,reason:"Delay"},
{text:"Document",correct:false,reason:"Trap"},
{text:"Give prescribed bronchodilator",correct:true},
{text:"Notify physician",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"MEDIUM",stem:"Post-op patient shallow breathing.",options:[
{text:"Reassess later",correct:false,reason:"Delay"},
{text:"Chart findings",correct:false,reason:"Paperwork"},
{text:"Stimulate and assess airway",correct:true},
{text:"Call MD",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"MEDIUM",stem:"Oâ‚‚ mask displaced.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Notify nurse later",correct:false,reason:"Waiting"},
{text:"Reapply immediately",correct:true},
{text:"Monitor",correct:false,reason:"Unsafe"}]},
{module:"AIRWAY",level:"MEDIUM",stem:"Tracheostomy secretions visible.",options:[
{text:"Chart amount",correct:false,reason:"Delay"},
{text:"Wait order",correct:false,reason:"Scope error"},
{text:"Clear airway per protocol",correct:true},
{text:"Observe",correct:false,reason:"Unsafe"}]},
{module:"AIRWAY",level:"MEDIUM",stem:"Oxygen tubing disconnected.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Notify MD",correct:false,reason:"Waiting"},
{text:"Reconnect immediately",correct:true},
{text:"Monitor",correct:false,reason:"Unsafe"}]},
{module:"AIRWAY",level:"MEDIUM",stem:"Patient anxious, RR rising.",options:[
{text:"Reassure only",correct:false,reason:"False calm"},
{text:"Chart anxiety",correct:false,reason:"Delay"},
{text:"Assess airway and breathing",correct:true},
{text:"Notify physician",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"MEDIUM",stem:"Coughing with cyanosis.",options:[
{text:"Observe",correct:false,reason:"Delay"},
{text:"Document",correct:false,reason:"Trap"},
{text:"Support airway immediately",correct:true},
{text:"Call MD",correct:false,reason:"Waiting"}]},

/* AUTOFAIL 16â€“20 */
{module:"AIRWAY",level:"AUTOFAIL",stem:"Unconscious, snoring respirations.",options:[
{text:"Monitor",correct:false,reason:"Airway ignored"},
{text:"Document",correct:false,reason:"Delay"},
{text:"Open airway and activate emergency",correct:true},
{text:"Wait for physician",correct:false,reason:"Unsafe wait"}]},
{module:"AIRWAY",level:"AUTOFAIL",stem:"Apnea observed.",options:[
{text:"Chart finding",correct:false,reason:"Catastrophic delay"},
{text:"Notify MD",correct:false,reason:"Waiting"},
{text:"Initiate emergency response",correct:true},
{text:"Observe",correct:false,reason:"Fatal"}]},
{module:"AIRWAY",level:"AUTOFAIL",stem:"Foreign body obstruction.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Wait order",correct:false,reason:"Unsafe"},
{text:"Immediate airway intervention",correct:true},
{text:"Monitor",correct:false,reason:"Fatal"}]},
{module:"AIRWAY",level:"AUTOFAIL",stem:"No breath sounds.",options:[
{text:"Reassess later",correct:false,reason:"Delay"},
{text:"Chart",correct:false,reason:"Trap"},
{text:"Emergency airway action",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"AIRWAY",level:"AUTOFAIL",stem:"Severe hypoxia persists.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Wait labs",correct:false,reason:"Unsafe"},
{text:"Immediate life-saving airway care",correct:true},
{text:"Monitor",correct:false,reason:"Fatal"}]},

/* =================================================
   CIRCULATION (20)
================================================= */
/* EASY */
{module:"CIRCULATION",level:"EASY",stem:"Active bleeding noted.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Notify MD",correct:false,reason:"Waiting"},
{text:"Apply direct pressure",correct:true},
{text:"Monitor vitals",correct:false,reason:"Unsafe"}]},
{module:"CIRCULATION",level:"EASY",stem:"BP 86/50, dizzy.",options:[
{text:"Recheck later",correct:false,reason:"Delay"},
{text:"Chart",correct:false,reason:"Trap"},
{text:"Position and assess circulation",correct:true},
{text:"Notify physician",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"EASY",stem:"Tachycardia present.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Observe",correct:false,reason:"Unsafe"},
{text:"Assess circulation immediately",correct:true},
{text:"Call MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"EASY",stem:"Cold, clammy skin.",options:[
{text:"Chart",correct:false,reason:"Delay"},
{text:"Monitor",correct:false,reason:"Unsafe"},
{text:"Assess for shock",correct:true},
{text:"Notify later",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"EASY",stem:"Bleeding through dressing.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Wait order",correct:false,reason:"Unsafe"},
{text:"Reinforce pressure",correct:true},
{text:"Monitor",correct:false,reason:"Unsafe"}]},
{module:"CIRCULATION",level:"EASY",stem:"Weak pulse noted.",options:[
{text:"Chart",correct:false,reason:"Delay"},
{text:"Observe",correct:false,reason:"Unsafe"},
{text:"Assess circulation now",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"EASY",stem:"Sudden dizziness standing.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Monitor",correct:false,reason:"Unsafe"},
{text:"Assist to safe position",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"EASY",stem:"Pale appearance.",options:[
{text:"Chart",correct:false,reason:"Delay"},
{text:"Observe",correct:false,reason:"Unsafe"},
{text:"Assess perfusion",correct:true},
{text:"Call physician",correct:false,reason:"Waiting"}]},

/* MEDIUM */
{module:"CIRCULATION",level:"MEDIUM",stem:"Post-op tachycardia.",options:[
{text:"Monitor",correct:false,reason:"Delay"},
{text:"Document",correct:false,reason:"Trap"},
{text:"Assess bleeding and perfusion",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"MEDIUM",stem:"Orthostatic hypotension.",options:[
{text:"Reassess later",correct:false,reason:"Delay"},
{text:"Chart",correct:false,reason:"Trap"},
{text:"Position safely",correct:true},
{text:"Call MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"MEDIUM",stem:"Rapid pulse after surgery.",options:[
{text:"Monitor",correct:false,reason:"Delay"},
{text:"Document",correct:false,reason:"Trap"},
{text:"Assess circulation immediately",correct:true},
{text:"Notify physician",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"MEDIUM",stem:"Cool extremities.",options:[
{text:"Observe",correct:false,reason:"Delay"},
{text:"Chart",correct:false,reason:"Trap"},
{text:"Assess perfusion",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"MEDIUM",stem:"Sudden weakness.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Monitor",correct:false,reason:"Unsafe"},
{text:"Assess circulation",correct:true},
{text:"Call MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"MEDIUM",stem:"Hypotension after meds.",options:[
{text:"Recheck later",correct:false,reason:"Delay"},
{text:"Chart",correct:false,reason:"Trap"},
{text:"Support circulation",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"MEDIUM",stem:"Decreased urine output.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Observe",correct:false,reason:"Unsafe"},
{text:"Assess perfusion",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},

/* AUTOFAIL */
{module:"CIRCULATION",level:"AUTOFAIL",stem:"Sudden hypotension, pale.",options:[
{text:"Chart",correct:false,reason:"Critical delay"},
{text:"Wait labs",correct:false,reason:"Unsafe"},
{text:"Emergency circulation support",correct:true},
{text:"Notify MD only",correct:false,reason:"Incomplete"}]},
{module:"CIRCULATION",level:"AUTOFAIL",stem:"Massive bleeding.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Call physician",correct:false,reason:"Waiting"},
{text:"Immediate hemorrhage control",correct:true},
{text:"Monitor",correct:false,reason:"Fatal"}]},
{module:"CIRCULATION",level:"AUTOFAIL",stem:"Signs of shock.",options:[
{text:"Observe",correct:false,reason:"Delay"},
{text:"Chart",correct:false,reason:"Trap"},
{text:"Activate emergency response",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
{module:"CIRCULATION",level:"AUTOFAIL",stem:"Collapse with weak pulse.",options:[
{text:"Document",correct:false,reason:"Delay"},
{text:"Wait help",correct:false,reason:"Unsafe"},
{text:"Immediate emergency action",correct:true},
{text:"Monitor",correct:false,reason:"Fatal"}]},
{module:"CIRCULATION",level:"AUTOFAIL",stem:"Post-op hemorrhage suspected.",options:[
{text:"Chart",correct:false,reason:"Delay"},
{text:"Observe",correct:false,reason:"Unsafe"},
{text:"Emergency circulation support",correct:true},
{text:"Notify MD",correct:false,reason:"Waiting"}]},
/* ðŸ”´ QUESTIONS 6â€“100 FOLLOW EXACT SAME STRUCTURE
   ðŸ”´ Each wrong option uses misleading wording:
      document / monitor / notify / reassess / wait / clarify later
   ðŸ”´ Each correct option is conservative + immediate + in scope
*/
];

function startExam() {
  user = document.getElementById("userId").value;
  if (!user) return alert("Enter User ID");
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");
  loadQuestion();
}

function loadQuestion() {
  if (current >= questions.length || failed) return endExam();
  const q = questions[current];
  document.getElementById("qNumber").innerText = `Question ${current + 1}`;
  document.getElementById("questionText").innerText = q.q;
  const optDiv = document.getElementById("options");
  optDiv.innerHTML = "";

  q.options.forEach(o => {
    const btn = document.createElement("button");
    btn.className = "option";
    btn.innerText = o.t;
    btn.onclick = () => selectOption(o);
    optDiv.appendChild(btn);
  });
}

function selectOption(option) {
  if (option.unsafe) {
    failed = true;
    failReason = option.reason;
  }
  current++;
  loadQuestion();
}

function endExam() {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("finalResult").innerHTML =
    failed ? "<span class='fail'>FAIL</span>" : "<span class='pass'>PASS</span>";
  document.getElementById("failReason").innerText =
    failed ? "Failure reason: " + failReason : "Safe decision-making demonstrated.";
}

function showDashboard() {
  document.getElementById("dashboard").classList.remove("hidden");
  document.getElementById("dUser").innerText = user;
  document.getElementById("dResult").innerText = failed ? "FAIL" : "PASS";
  document.getElementById("dRisk").innerText = failed ? failReason : "None";
}
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Prometric Fast-Fail System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
}
.container {
  max-width: 900px;
  margin: auto;
  background: #fff;
  padding: 20px;
  min-height: 100vh;
}
h1, h2 {
  color: #b00020;
}
.option {
  border: 1px solid #ccc;
  padding: 12px;
  margin: 10px 0;
  cursor: pointer;
}
.option:hover {
  background: #eee;
}
.timer {
  font-weight: bold;
  color: #b00020;
}
.hidden { display: none; }
.fail { color: red; font-weight: bold; }
.pass { color: green; font-weight: bold; }
table {
  width: 100%;
  border-collapse: collapse;
}
th, td {
  border: 1px solid #ccc;
  padding: 10px;
}
th {
  background: #eee;
}
button {
  padding: 10px 16px;
  margin-top: 10px;
}
</style>
</head>

<body>
<div class="container">

<!-- HOME -->
<div id="home">
  <h1>SCFHS Prometric Fast-Fail System</h1>
  <button onclick="showExam()">Start Exam</button>
  <button onclick="showDashboard()">Instructor Dashboard</button>
</div>

<!-- LOGIN -->
<div id="login" class="hidden">
  <h2>Candidate Login</h2>
  <input id="userId" placeholder="Enter User ID">
  <button onclick="startExam()">Begin</button>
</div>

<!-- EXAM -->
<div id="exam" class="hidden">
  <p>User: <span id="userDisplay"></span></p>
  <p class="timer">Time left: <span id="time">10</span>s</p>
  <h2 id="moduleTitle"></h2>
  <div id="questionBox"></div>
</div>

<!-- RESULT -->
<div id="result" class="hidden">
  <h1 id="resultTitle"></h1>
  <p id="resultText"></p>
  <button onclick="location.reload()">Exit</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">
  <h1>Instructor Dashboard</h1>
  <table>
    <thead>
      <tr>
        <th>User ID</th>
        <th>Result</th>
        <th>Risk Pattern</th>
        <th>Time</th>
      </tr>
    </thead>
    <tbody id="dashTable"></tbody>
  </table>
  <button onclick="location.reload()">Exit</button>
</div>

</div>

<script>
/* ================= QUESTION BANK (SHORTENED DEMO)
   Add remaining questions following same pattern
=============================================== */

const questions = [
{
 module:"AIRWAY", level:"EASY",
 stem:"Patient suddenly becomes cyanotic with SpOâ‚‚ 82%.",
 options:[
  {text:"Document oxygen saturation", correct:false, reason:"Documentation during hypoxia"},
  {text:"Notify physician", correct:false, reason:"Waiting for orders"},
  {text:"Apply oxygen and assess airway", correct:true},
  {text:"Reassure and monitor", correct:false, reason:"Reassurance during instability"}
 ]
},
{
 module:"AIRWAY", level:"AUTOFAIL",
 stem:"Unconscious patient with snoring respirations.",
 options:[
  {text:"Document findings", correct:false, reason:"Dangerous delay"},
  {text:"Wait for physician", correct:false, reason:"Unsafe waiting"},
  {text:"Open airway and activate emergency response", correct:true},
  {text:"Monitor closely", correct:false, reason:"Airway obstruction ignored"}
 ]
},
{
 module:"CIRCULATION", level:"AUTOFAIL",
 stem:"Post-op patient suddenly pale and hypotensive.",
 options:[
  {text:"Document vital signs", correct:false, reason:"Hemorrhage delay"},
  {text:"Wait for labs", correct:false, reason:"Life-threatening delay"},
  {text:"Initiate emergency response", correct:true},
  {text:"Notify physician only", correct:false, reason:"Incomplete response"}
 ]
},
{
 module:"SCOPE", level:"AUTOFAIL",
 stem:"Ordered to perform IV medication outside technician scope.",
 options:[
  {text:"Follow order", correct:false, reason:"Scope violation"},
  {text:"Document order", correct:false, reason:"Unsafe compliance"},
  {text:"Refuse and escalate", correct:true},
  {text:"Delay action", correct:false, reason:"Avoidance"}
 ]
}
];

/* ================= EXAM ENGINE ================= */

let idx = 0;
let timeLeft = 10;
let timer;
let failed = false;
let user = "";
let failReason = "";

function showExam() {
  home.hidden = true;
  login.hidden = false;
}
function showDashboard() {
  home.hidden = true;
  dashboard.hidden = false;
  loadDashboard();
}

function startExam() {
  user = userId.value;
  if (!user) return alert("Enter User ID");
  userDisplay.innerText = user;
  login.hidden = true;
  exam.hidden = false;
  loadQuestion();
}

function loadQuestion() {
  if (idx >= questions.length || failed) return endExam();
  timeLeft = 10;
  time.innerText = timeLeft;
  const q = questions[idx];
  moduleTitle.innerText = q.module + " â€” " + q.level;
  questionBox.innerHTML = "<p>" + q.stem + "</p>";

  q.options.forEach(o => {
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = o.text;
    div.onclick = () => answer(o, q);
    questionBox.appendChild(div);
  });

  timer = setInterval(() => {
    timeLeft--;
    time.innerText = timeLeft;
    if (timeLeft <= 0) fail("Time expired â€” unsafe delay");
  }, 1000);
}

function answer(opt, q) {
  clearInterval(timer);
  if (!opt.correct) {
    if (q.level === "AUTOFAIL" || q.module === "AIRWAY") {
      fail(opt.reason);
      return;
    }
  }
  idx++;
  loadQuestion();
}

function fail(reason) {
  failed = true;
  failReason = reason;
  endExam();
}

function endExam() {
  exam.hidden = true;
  result.hidden = false;

  const record = {
    user, result: failed ? "FAIL" : "PASS",
    reason: failReason,
    time: new Date().toLocaleString()
  };

  let data = JSON.parse(localStorage.getItem("results")) || [];
  data.push(record);
  localStorage.setItem("results", JSON.stringify(data));

  resultTitle.innerText = failed ? "FAIL âŒ" : "PASS âœ…";
  resultText.innerHTML = failed
    ? `Reason: ${failReason}<br>Unsafe decision profile`
    : "Safe decision-making demonstrated";
}

/* ================= DASHBOARD ================= */

function loadDashboard() {
  const rows = JSON.parse(localStorage.getItem("results")) || [];
  dashTable.innerHTML = "";
  rows.forEach(r => {
    const risk =
      r.reason.includes("delay") ? "Delay Bias" :
      r.reason.includes("Document") ? "Documentation Reflex" :
      r.reason.includes("scope") ? "Scope Violation" :
      r.reason.includes("airway") ? "ABC Violation" :
      r.reason ? "Unsafe Decision" : "Safe";

    dashTable.innerHTML += `
      <tr>
        <td>${r.user}</td>
        <td class="${r.result === "FAIL" ? "fail" : "pass"}">${r.result}</td>
        <td>${risk}</td>
        <td>${r.time}</td>
      </tr>`;
  });
}
</script>
</body>
</html>
